<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
    
    <title>Destroy all for loops | Azhar Khan &middot; Azhar Khan is an independent data engineer and developer from Ottawa, Canada.</title>
    <meta name="title" content="Destroy all for loops | Azhar Khan &middot; Azhar Khan is an independent data engineer and developer from Ottawa, Canada.">
    
    <meta name="description" content="Making improvements to a todo list app using higher order functions and callback functions.">
    <meta name="keywords" content="Data Engineering, Data Science, AI, Analytics, Design, UX, UI, Product">
    <meta http-equiv="content-language" content="en" />
    
    <meta property="og:title" content="Destroy all for loops | Azhar Khan &middot; Azhar Khan is an independent data engineer and developer from Ottawa, Canada.">
    <meta property="og:description" content="Making improvements to a todo list app using higher order functions and callback functions.">
    <meta property="og:site_name" content="Destroy all for loops | Azhar Khan &middot; Azhar Khan is an independent data engineer and developer from Ottawa, Canada.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://azharkhan.in/notes/destroy-all-for-loops/">
    
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://azharkhan.in/notes/destroy-all-for-loops/">
    <meta property="twitter:title" content="Destroy all for loops - Azhar Khan">
    <meta property="twitter:description" content=" Making improvements to a todo list app using higher order functions and callback functions. Blog posts on code and design by github.com/XOR97">
    <link rel="canonical" href="https://azharkhan.in/notes/destroy-all-for-loops/">
    
    
    
    <meta name="p:domain_verify" content="c60dc1e9be844be29f0fb5525b9afe6f"/>
    
    <meta name="google-site-verification" content="9G-wiIrmxQgDxbcs3a3xPW--q3Mxb1VGFN7BsEfJdDk" />
    
    <meta name="pinterest" content="nopin" />
        
    <meta name="author" content="Azhar Khan">
    <link href="mailto:azhar932@icloud.com" rel="me">
    <link href="https://twitter.com/Azhr_K_" rel="me">
    <link href="https://github.com/XOR97" rel="me">
    <link href="https://www.linkedin.com/in/azhar93/" rel="me">
    
    <link rel="webmention" href="https://webmention.io/harrycresswell.com/webmention" />
    <link rel="pingback" href="https://webmention.io/harrycresswell.com/xmlrpc" />
    
    
      
      
       
      
      
      <link rel="stylesheet" href="https://azharkhan.in/css/main.min.bf08fe8d86332cb842d75cf7df24b0b53fd52f2d350e68cea9eea8bdf244050b.css" integrity="sha256-vwj&#43;jYYzLLhC11z33ySwtT/VLy01DmjOqe6ovfJEBQs=" media="screen">
    
    
    <link rel="apple-touch-icon" href="https://azharkhan.in/img/apple-touch-icon.png" sizes="180x180">
    <link rel="icon" href="https://azharkhan.in/img/favicon-32x32.png" sizes="32x32" type="image/png">
    <link rel="icon" href="https://azharkhan.in/img/favicon-16x16.png" sizes="16x16" type="image/png">
    <link rel="shortcut icon" href="https://azharkhan.in/img/favicon.ico" type="image/x-icon">
    
    </head>
	<body class="Wrapper h-card">
  <a class="skip-link" href="#main-content">Skip to main content</a>
  <header class="Header">
    <div class="Title">
      <a class="p-name u-url" rel="me" href="https://azharkhan.in/">Azhar Khan</a>
      <div hidden>
          <img class="u-photo" src="https://harrycresswell.com/img/hc.jpg" alt="Harry Cresswell">
          <p class="p-note">Azhar Khan is an independent data engineer and developer from Ottawa, Canada.</p>
          <a href="mailto:studio@harrycresswell.com" rel="me" class="u-email">studio@harrycresswell.com</a>
      </div>
    </div>
    <nav class="Nav" aria-label="Main Navigation">
      <ul class="Nav-list">
       
        
        <li class="Nav-listItem">
          <a class="Nav-listItemLink" href="/articles/">Articles</a>
        </li>
      
        <li class="Nav-listItem">
          <a class="Nav-listItemLink" href="/notes/">Notes</a>
        </li>
      
        <li class="Nav-listItem">
          <a class="Nav-listItemLink" href="/tags/">Tags</a>
        </li>
      
      </ul>
    </nav>
  </header>

    <main id="main-content" class="Container">
    
      
  <article id="content" class="Post h-entry">

      <header class="PostHeader">
          <h1 class="PostHeader-title p-name">Destroy all for loops</h1>
      </header>

      <section class="PostMeta">
        <time class="PostMeta-date dt-published">Wed, May 29, 2019</time> —
        
<div class="PostMeta-tags">
    <div class="PostMeta-tag">
      
      
        <a href="/tags/javascript" class="p-category">JavaScript</a>
      
        <a href="/tags/coursenotes" class="p-category">Coursenotes</a>
      
    </div>
</div>

      </section>

      <section class="PostBody e-content">
        <p>These are my notes from Gordon Zhu’s free course <a href="https://watchandcode.com/p/practical-javascript">Practical JavaScript</a>, which teaches you how to create a todo app in vanilla JavaScript.</p>
<p>Now we’ve had some practice with Higher Order Functions and Callback Functions, theres a few places in our app that we can make improvements using what we know.</p>
<p>Version 11 will look at refactoring our code to use these new methods.</p>
<h2 id="requirements-v11">Requirements v11&nbsp;<a class="heading-anchor" href="#requirements-v11" aria-label="Anchor">#</a> </h2>
<ul>
<li><code>todoList.toggleAll</code> should use <code>forEach</code></li>
<li><code>view.displayTodos</code> should use <code>forEach</code></li>
</ul>
<p>At the end of this version we will have replaced all <code>for</code> loops in our app wth <code>forEach</code>.</p>
<h2 id="todolisttoggleall-should-use-foreach">todoList.toggleAll should use forEach&nbsp;<a class="heading-anchor" href="#todolisttoggleall-should-use-foreach" aria-label="Anchor">#</a> </h2>
<p>Our <code>toggleAll</code> method on the <code>todoList</code> object currently has 3 <code>for</code> loops. In this part we’ll focus on one at a time and refactor the code into a <code>forEach</code> function.</p>
<p>We can comment out the first one so we can see what behaviour we need to replicate.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// for (var i = 0; i &lt; totalTodos; i++) {
</span><span class="c1">//   if (this.todos[i].completed === true) {
</span><span class="c1">//     completedTodos++;
</span><span class="c1">//   }
</span><span class="c1">// }
</span></code></pre></div><p>Once we have it working the way we want it we can get rid of this old code.</p>
<p>Now we can use the built in <code>forEach</code> method that every array comes with. So if you think about what’s happening in the code above, we’re trying to iterate over all items in <code>this.todos</code>.</p>
<p>First we can grab <code>this.todos</code> then call the <code>forEach</code> method.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// for (var i = 0; i &lt; totalTodos; i++) {
</span><span class="c1">//   if (this.todos[i].completed === true) {
</span><span class="c1">//     completedTodos++;
</span><span class="c1">//   }
</span><span class="c1">// }
</span><span class="c1"></span><span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">();</span>
</code></pre></div><p>Then we need to give <code>forEach</code> a callback function, which <code>forEach</code> will run for us. Each time it runs the function, it will pass in each item in the array. So we will need to pass in the <code>todo</code> parameter to make this happen.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// for (var i = 0; i &lt; totalTodos; i++) {
</span><span class="c1">//   if (this.todos[i].completed === true) {
</span><span class="c1">//     completedTodos++;
</span><span class="c1">//   }
</span><span class="c1">// }
</span><span class="c1"></span><span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
<span class="p">});</span>
</code></pre></div><p>Next, the code is more or less the same, except we no longer need to pass in <code>i</code>, as our <code>for</code> loop no longer exists.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// for (var i = 0; i &lt; totalTodos; i++) {
</span><span class="c1">//   if (this.todos[i].completed === true) {
</span><span class="c1">//     completedTodos++;
</span><span class="c1">//   }
</span><span class="c1">// }
</span><span class="c1"></span><span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">==</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">completedTodos</span><span class="o">++</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><p>Now we can remove the old code we commeneted out and take a look at the second <code>for</code> loop statement.</p>
<p>Again, we can start by commenting out the code.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// Case 1: If everything’s true, make everything false.
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nx">completedTodos</span> <span class="o">===</span> <span class="nx">totalTodos</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// for (var i = 0; i &lt; totalTodos; i++) {
</span><span class="c1"></span>  <span class="c1">//   this.todos[i].completed = false;
</span><span class="c1"></span>  <span class="c1">// }
</span><span class="c1"></span><span class="p">}</span>
</code></pre></div><p>In this case, the <code>forEach</code> is very similar to before, where we call <code>forEach</code> on <code>this.todos</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// Case 1: If everything’s true, make everything false.
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nx">completedTodos</span> <span class="o">===</span> <span class="nx">totalTodos</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// for (var i = 0; i &lt; totalTodos; i++) {
</span><span class="c1"></span>  <span class="c1">//   this.todos[i].completed = false;
</span><span class="c1"></span>  <span class="c1">// }
</span><span class="c1"></span>  <span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>

  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div><p>The next step is to take <code>todo.completed</code> and set it to <code>false</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// Case 1: If everything’s true, make everything false.
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nx">completedTodos</span> <span class="o">===</span> <span class="nx">totalTodos</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// for (var i = 0; i &lt; totalTodos; i++) {
</span><span class="c1"></span>  <span class="c1">//   this.todos[i].completed = false;
</span><span class="c1"></span>  <span class="c1">// }
</span><span class="c1"></span>  <span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div><p>Now we can remove the old code as before.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// Case 1: If everything’s true, make everything false.
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nx">completedTodos</span> <span class="o">===</span> <span class="nx">totalTodos</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">}</span>
</code></pre></div><p>The <code>forEach</code> inside the <code>else</code> statement will replace the <code>for</code> loop in the exact same way, but this time <code>todo.completed</code> will be set to <code>true</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// Case 1: If everything’s true, make everything false.
</span><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="nx">completedTodos</span> <span class="o">===</span> <span class="nx">totalTodos</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">});</span>
  <span class="c1">// Case 2: Otherwise, make everything true.
</span><span class="c1"></span><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre></div><p>There’s one more optimisation we can make now we’ve replaces our <code>for</code> loops with <code>forEach</code>. That is to collaspe the two <code>forEach</code> statements inside the <code>if else</code> statement into one single <code>forEach</code>.</p>
<p>The way we can achieve this is to have the <code>forEach</code> outside and then depending on if <code>completed === totalTodos</code>, we set it to <code>true</code> or <code>false</code></p>
<p>So now we can comment out the whole section. And write out the refactored code, starting with our <code>forEach</code> statement.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// // Case 1: If everything’s true, make everything false.
</span><span class="c1">// if (completedTodos === totalTodos) {
</span><span class="c1">//   this.todos.forEach(function(todo) {
</span><span class="c1">//     todo.completed = false;
</span><span class="c1">//   });
</span><span class="c1">//   // Case 2: Otherwise, make everything true.
</span><span class="c1">// } else {
</span><span class="c1">//   this.todos.forEach(function(todo) {
</span><span class="c1">//     todo.completed = true;
</span><span class="c1">//   });
</span><span class="c1">// };
</span><span class="c1"></span>
<span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>

<span class="p">});</span>
</code></pre></div><p>The logic here will still be exactly the same as before. If <code>completedTdodos === totalTodos</code> we want to make everything <code>false</code>. Otheriwse make everything <code>true</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// // Case 1: If everything’s true, make everything false.
</span><span class="c1">// if (completedTodos === totalTodos) {
</span><span class="c1">//   this.todos.forEach(function(todo) {
</span><span class="c1">//     todo.completed = false;
</span><span class="c1">//   });
</span><span class="c1">//   // Case 2: Otherwise, make everything true.
</span><span class="c1">// } else {
</span><span class="c1">//   this.todos.forEach(function(todo) {
</span><span class="c1">//     todo.completed = true;
</span><span class="c1">//   });
</span><span class="c1">// };
</span><span class="c1"></span><span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Case 1: If everything’s true, make everything false.
</span><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nx">completedTodos</span> <span class="o">===</span> <span class="nx">totalTodos</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="c1">// Case 2: Otherwise, make everything true.
</span><span class="c1"></span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><p>Now our code only has one <code>forEach</code> and is a bit shorter. It is however a bit more complicated, hense why we didn’t do this in the first place. Now you can see how you can write the same things in multiple ways, using two different implementations.</p>
<p>The final thing is to remove the commented code from before and test our app is working with the refactored code. We can test our app by checking that each case is met.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="k">this</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Case 1: If everything’s true, make everything false.
</span><span class="c1"></span>  <span class="k">if</span> <span class="p">(</span><span class="nx">completedTodos</span> <span class="o">===</span> <span class="nx">totalTodos</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="c1">// Case 2: Otherwise, make everything true.
</span><span class="c1"></span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div><h2 id="viewdisplaytodos-should-use-foreach">view.displayTodos should use forEach&nbsp;<a class="heading-anchor" href="#viewdisplaytodos-should-use-foreach" aria-label="Anchor">#</a> </h2>
<p>Next we need to get rid of our last <code>for</code> loop by using <code>forEach</code> in <code>view.displayTodos</code>.</p>
<p>In the <code>displayTodos</code> method we can start by commenting out the <code>for</code> statement.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// for (var i = 0; i &lt; todoList.todos.length; i++) {
</span><span class="c1">//   var todoLi = document.createElement(&#39;li&#39;);
</span><span class="c1">//   var todo = todoList.todos[i];
</span><span class="c1">//   var todoTextWithCompletion = &#39;&#39;;
</span><span class="c1">//
</span><span class="c1">//   if (todo.completed === true) {
</span><span class="c1">//        todoTextWithCompletion = &#39;(x) &#39; + todo.todoText;
</span><span class="c1">//    } else {
</span><span class="c1">//      todoTextWithCompletion = &#39;( ) &#39; + todo.todoText;
</span><span class="c1">//    }
</span><span class="c1">//
</span><span class="c1">//   todoLi.id = i;
</span><span class="c1">//   todoLi.textContent = todoTextWithCompletion;
</span><span class="c1">//   todoLi.appendChild(this.createDeleteButton());
</span><span class="c1">//   todosUl.appendChild(todoLi);
</span><span class="c1">// }
</span></code></pre></div><p>Next we want to iterate over the todo items and call <code>forEach</code>. Then we want to pass the callback function that has access to each item in the array. We can use the <code>todo</code> variable name as the parameter.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="c1">// for (var i = 0; i &lt; todoList.todos.length; i++) {
</span><span class="c1">//   var todoLi = document.createElement(&#39;li&#39;);
</span><span class="c1">//   var todo = todoList.todos[i];
</span><span class="c1">//   var todoTextWithCompletion = &#39;&#39;;
</span><span class="c1">//
</span><span class="c1">//   if (todo.completed === true) {
</span><span class="c1">//        todoTextWithCompletion = &#39;(x) &#39; + todo.todoText;
</span><span class="c1">//    } else {
</span><span class="c1">//      todoTextWithCompletion = &#39;( ) &#39; + todo.todoText;
</span><span class="c1">//    }
</span><span class="c1">//
</span><span class="c1">//   todoLi.id = i;
</span><span class="c1">//   todoLi.textContent = todoTextWithCompletion;
</span><span class="c1">//   todoLi.appendChild(this.createDeleteButton());
</span><span class="c1">//   todosUl.appendChild(todoLi);
</span><span class="c1">// }
</span><span class="c1"></span>
<span class="nx">todoList</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>

<span class="p">});</span>
</code></pre></div><p>Next we can paste in the code from before, which sits inside the old <code>for</code> loop, and modify it as needed.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">todoList</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">//   var todoLi = document.createElement(&#39;li&#39;);
</span><span class="c1"></span>  <span class="c1">//   var todo = todoList.todos[i];
</span><span class="c1"></span>  <span class="c1">//   var todoTextWithCompletion = &#39;&#39;;
</span><span class="c1"></span>  <span class="c1">//
</span><span class="c1"></span>  <span class="c1">//   if (todo.completed === true) {
</span><span class="c1"></span>  <span class="c1">//        todoTextWithCompletion = &#39;(x) &#39; + todo.todoText;
</span><span class="c1"></span>  <span class="c1">//    } else {
</span><span class="c1"></span>  <span class="c1">//      todoTextWithCompletion = &#39;( ) &#39; + todo.todoText;
</span><span class="c1"></span>  <span class="c1">//    }
</span><span class="c1"></span>  <span class="c1">//
</span><span class="c1"></span>  <span class="c1">//   todoLi.id = i;
</span><span class="c1"></span>  <span class="c1">//   todoLi.textContent = todoTextWithCompletion;
</span><span class="c1"></span>  <span class="c1">//   todoLi.appendChild(this.createDeleteButton());
</span><span class="c1"></span>  <span class="c1">//   todosUl.appendChild(todoLi);
</span><span class="c1"></span><span class="p">});</span>
</code></pre></div><p>The first line looks fine, though the second isn’t necessary as we no longer use <code>i</code> to get access to each object in the arrya. This came from the <code>for</code> loop which we replaced with <code>forEach</code>.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">todoList</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">todoLi</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">);</span>
  <span class="c1">//var todoTextWithCompletion = &#39;&#39;;
</span><span class="c1"></span>  <span class="c1">//
</span><span class="c1"></span>  <span class="c1">//   if (todo.completed === true) {
</span><span class="c1"></span>  <span class="c1">//        todoTextWithCompletion = &#39;(x) &#39; + todo.todoText;
</span><span class="c1"></span>  <span class="c1">//    } else {
</span><span class="c1"></span>  <span class="c1">//      todoTextWithCompletion = &#39;( ) &#39; + todo.todoText;
</span><span class="c1"></span>  <span class="c1">//    }
</span><span class="c1"></span>  <span class="c1">//
</span><span class="c1"></span>  <span class="c1">//   todoLi.id = i;
</span><span class="c1"></span>  <span class="c1">//   todoLi.textContent = todoTextWithCompletion;
</span><span class="c1"></span>  <span class="c1">//   todoLi.appendChild(this.createDeleteButton());
</span><span class="c1"></span>  <span class="c1">//   todosUl.appendChild(todoLi);
</span><span class="c1"></span><span class="p">});</span>
</code></pre></div><p>The next few lines look good because they use the variable <code>todo</code> which we have access to in our callback function.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">todoList</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">todoLi</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">todoTextWithCompletion</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">todoTextWithCompletion</span> <span class="o">=</span> <span class="s1">&#39;(x) &#39;</span> <span class="o">+</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">todoText</span><span class="p">;</span>
     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
       <span class="nx">todoTextWithCompletion</span> <span class="o">=</span> <span class="s1">&#39;( ) &#39;</span> <span class="o">+</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">todoText</span><span class="p">;</span>
     <span class="p">}</span>
  <span class="c1">//
</span><span class="c1"></span>  <span class="c1">//   todoLi.id = i;
</span><span class="c1"></span>  <span class="c1">//   todoLi.textContent = todoTextWithCompletion;
</span><span class="c1"></span>  <span class="c1">//   todoLi.appendChild(this.createDeleteButton());
</span><span class="c1"></span>  <span class="c1">//   todosUl.appendChild(todoLi);
</span><span class="c1"></span><span class="p">});</span>
</code></pre></div><p>The line <code>todoLi.id = i;</code> causes a problem. We need the position of the element in the array which we grabbed previously using <code>i</code>. We can pass in an additional argument to our callback function on <code>forEach</code> called <code>position</code>. This is equivilant to <code>i</code>. Now it will work as before.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">todoList</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">todoLi</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">todoTextWithCompletion</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">todoTextWithCompletion</span> <span class="o">=</span> <span class="s1">&#39;(x) &#39;</span> <span class="o">+</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">todoText</span><span class="p">;</span>
     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
       <span class="nx">todoTextWithCompletion</span> <span class="o">=</span> <span class="s1">&#39;( ) &#39;</span> <span class="o">+</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">todoText</span><span class="p">;</span>
     <span class="p">}</span>

  <span class="nx">todoLi</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">position</span><span class="p">;</span>
  <span class="c1">//   todoLi.textContent = todoTextWithCompletion;
</span><span class="c1"></span>  <span class="c1">//   todoLi.appendChild(this.createDeleteButton());
</span><span class="c1"></span>  <span class="c1">//   todosUl.appendChild(todoLi);
</span><span class="c1"></span><span class="p">});</span>
</code></pre></div><p>The final 3 lines look good but one line will cause the following error: <code>this.createDeleteButton is not a function</code>.</p>
<p>The problem is our callback function in <code>forEach</code> is not directly on the <code>view</code> object that <code>this.createDeleteButton</code> is trying to access. It’s one level deeper. If we want <code>this</code> in our callback function to refer to <code>this</code> in our <code>displayTodos</code> function, we can pass in another <code>this</code>, inside the <code>forEach</code> to refer to the <code>view</code> object.</p>
<p>We can write that like: <code>forEach(callback, this);</code>. So <code>this</code> must go after our callback function, as a second argument in <code>forEach</code>. Now, with <code>this</code> at the very end of our <code>forEach</code> statment, our code will run without errors, as we are now refering to the <code>view</code> object.</p>
<div class="highlight"><pre class="chroma"><code class="language-javascript" data-lang="javascript"><span class="nx">todoList</span><span class="p">.</span><span class="nx">todos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">todo</span><span class="p">,</span> <span class="nx">position</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">todoLi</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">todoTextWithCompletion</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">todo</span><span class="p">.</span><span class="nx">completed</span> <span class="o">===</span> <span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
         <span class="nx">todoTextWithCompletion</span> <span class="o">=</span> <span class="s1">&#39;(x) &#39;</span> <span class="o">+</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">todoText</span><span class="p">;</span>
     <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
       <span class="nx">todoTextWithCompletion</span> <span class="o">=</span> <span class="s1">&#39;( ) &#39;</span> <span class="o">+</span> <span class="nx">todo</span><span class="p">.</span><span class="nx">todoText</span><span class="p">;</span>
     <span class="p">}</span>

  <span class="nx">todoLi</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">position</span><span class="p">;</span>
  <span class="nx">todoLi</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">todoTextWithCompletion</span><span class="p">;</span>
  <span class="nx">todoLi</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">createDeleteButton</span><span class="p">());</span>
  <span class="nx">todosUl</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">todoLi</span><span class="p">);</span>
<span class="p">},</span> <span class="k">this</span><span class="p">);</span>
</code></pre></div><p>You can read more about the <code>this</code> argument in <code>forEach</code> in the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach#Parameters">MDN Web Docs</a>.</p>
<h2 id="review-v11">Review v.11&nbsp;<a class="heading-anchor" href="#review-v11" aria-label="Anchor">#</a> </h2>
<p>We’ve now removed all <code>for</code> loops from our application.</p>
<p>First we changed the <code>for</code> loops in <code>toggleAll</code> to <code>forEach</code> statements. We also colapsed 2 <code>for</code> loops into one <code>forEach</code> by moving our <code>if</code> statement inside of the <code>forEach</code>.</p>
<p>The second thing we did was in the <code>displayTodos</code> method. We learn’t how <code>this</code> inside a callback function will not be equal to the <code>view</code> object. However we can make it equal to the <code>view</code> object by passing in another <code>this</code> to the <code>forEach</code>, right after the callback function. Now when you access <code>this</code> inside the callback function, in this case in <code>this.createDeleteButton</code>, it will be equal to the <code>view</code> object.</p>
<p>The final subtly we practiced was the use of <code>position</code>, a second argument we can pass into a callback function which grabs the position of an item in an array. So now we know we can access the item and the position.</p>
<p>The main thing to take away is that the behaviour of the <code>this</code> keyword inside of a callback function in a <code>forEach</code> is not the same as <code>this</code> on a method, so we have to add a second <code>this</code> keyword after the callback function to refer to the parent object.</p>
 
      </section>

      <footer>
      
<div class="PostAuthor">
  <img alt="Harry Cresswell" class="Avatar Avatar--round Avatar--m u-photo" src="https://harrycresswell.com/img/hc.jpg">
  <div class="PostAuthor-text">
    <h4>Did you enjoy this?</h4>
    <p>Sign up for my newsletter below &darr;</p>
  </div>
</div>


<div hidden>
  <a class="u-url" href="https://azharkhan.in/articles/accessibility-checking-writing-mac-os/">Accessibility check your writing on macOS</a>
  <p class="h-card p-author">
    <a class="p-name u-url" href="https://azharkhan.in/" rel="author">Harry Cresswell</a>
    <img alt="Harry Cresswell" class="u-photo" src="https://harrycresswell.com/img/hc.jpg">
  </p>
</div>
      </footer>

  </article>


    </main>

    <section class="Newsletter" id="braintactics">
    <h3 class="Newsletter-title">Weekly Newsletter</h3>
    <p><a href="/newsletter/">Braintactics</a> is a weekly roundup of articles, tools and tips for product designers and front-end developers. I send it every Friday morning.</p>

    <form class="NewsletterForm validate" action="https://harrycresswell.us14.list-manage.com/subscribe/post?u=4e8fba8d0ab4a857159c0104e&amp;id=d6ad2b65ca" method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate>
        
        <div class="NewsletterForm-field">
            <label class="NewsletterForm-label" for="name">
            First Name
            </label>
            <input class="NewsletterForm-input" id="name" name="NAME" placeholder="e.g. Harry" type="text">
        </div>

        <div class="NewsletterForm-field">
            <label class="NewsletterForm-label" for="email">
            Email Address
            </label>
            <input class="NewsletterForm-input" id="email" name="EMAIL" placeholder="e.g. harry@gmail.com" type="email">
        </div>
        <div class="NewsletterForm-field">
        
            
            <input class="u-visually-hidden" name="LOCATION" value="Destroy all for loops" type="hidden" id="mce-LOCATION">
            
        
            <div class="Form-options" style="display:none">
                <strong>Product </strong>
                <ul>
                    <li>
                        <input type="checkbox" value="4" name="group[6417][4]" id="mce-group[6417]-6417-0" checked>
                        <label for="mce-group[6417]-6417-0">Braintactics</label>
                    </li>
                    <li>
                        <input type="checkbox" value="8" name="group[6417][8]" id="mce-group[6417]-6417-1">
                        <label for="mce-group[6417]-6417-1">DS in Sketch</label>
                    </li>
                </ul>
            </div>
            <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
            </div>
            
            <div style="position: absolute; left: -5000px;" aria-hidden="true">
                <label for="b_4e8fba8d0ab4a857159c0104e_d6ad2b65ca">Prevent bot signups</label>
                <input type="text" name="b_4e8fba8d0ab4a857159c0104e_d6ad2b65ca" tabindex="-1" value="">
            </div>

            <div class="NewsletterForm-button">
                <label class="NewsletterForm-label u-visually-hidden" for="subscribe">Subscribe</label>
                <input class="Button Button--primary" name="subscribe" type="submit" value="Subscribe">
            </div>
        </div>
    </form>
</section>

  <footer class="Footer" role="contentinfo">
    <nav class="FooterNav" aria-label="Footer Navigation">
      
      
      <a class="FooterNav-link"
        href="/articles/">Articles</a>
      
      <a class="FooterNav-link"
        href="/notes/">Notes</a>
      
      <a class="FooterNav-link"
        href="/tags/">Tags</a>
      
    </nav>
    <p>Content &copy;2020 Harry Cresswell, unless otherwise specified. Subscribe to RSS Feeds for <a
        href="https://azharkhan.in/feed.xml">all content</a>, <a
        href="https://azharkhan.in/articles/feed.xml">articles</a> or <a
        href="https://azharkhan.in/notes/feed.xml">notes</a>.</p>
  </footer>

  
  
  
  

  
  
  
  
  
  
  
  
  
  
  <script src="https://azharkhan.in/app.min.633fdaa2db6cbb9888b8f7ce0cb9fff72b593e1c71be0f9a84142171ddb816a5.js" integrity="sha256-Yz/aottsu5iIuPfODLn/9ytZPhxxvg&#43;ahBQhcd24FqU=" media="screen"></script>
  <script>
    var cl = cloudinary.Cloudinary.new({
      cloud_name: "harrycresswell"
    });

    cl.responsive();
  </script>
  </body>

  </html>